<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laurino Tavern - Manager Display</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Laurino Tavern Brand Colors - Light Mode */
            --primary-dark: #8B7355;
            --secondary-dark: #A68B6B;
            --tertiary-dark: #2C5F7C;
            --primary-light: #ffffff;
            --blue-pastel: #7FA7B8;
            --lighter-blue: #A8C4D4;
            --background: #FAF8F5;
            --accent: #E8DFD3;
            --highlight: #D4A574;
            --card-background: #ffffff;
            --border: #e0e0e0;
            --text: #8B7355;
            --text-primary: #5a4a3a;
            --muted-text: #A68B6B;
            --shadow-light: 0 2px 8px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 4px 16px rgba(0, 0, 0, 0.12);
            --shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.16);
            --radius-small: 6px;
            --radius-medium: 8px;
            --radius-large: 12px;
            --radius-xl: 16px;
        }

        /* Dark Mode Colors */
        [data-theme="dark"] {
            --primary-dark: #D4A574;
            --secondary-dark: #A68B6B;
            --tertiary-dark: #7FA7B8;
            --primary-light: #1a1a1a;
            --blue-pastel: #5a8a9a;
            --lighter-blue: #4a7a8a;
            --background: #1a1612;
            --accent: #2a2420;
            --highlight: #D4A574;
            --card-background: #252018;
            --border: #3a3530;
            --text: #E8DFD3;
            --text-primary: #ffffff;
            --muted-text: #A68B6B;
            --shadow-light: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-medium: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        html, body {
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            background: var(--background);
            color: var(--text);
            height: 100vh;
            padding: 24px 32px;
            -webkit-font-smoothing: antialiased;
            transition: background 0.3s ease, color 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* Header - Compact for monitor */
        .header {
            text-align: center;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--accent);
            margin-bottom: 20px;
            flex-shrink: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            text-align: left;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.4rem;
            font-weight: 700;
            color: var(--primary-dark);
            letter-spacing: 0.03em;
            line-height: 1.1;
        }

        .header .subtitle {
            font-size: 0.95rem;
            color: var(--tertiary-dark);
            letter-spacing: 0.12em;
            text-transform: uppercase;
            margin-top: 4px;
        }

        .header-right {
            text-align: right;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }

        .current-date {
            font-size: 1.1rem;
            color: var(--secondary-dark);
            font-weight: 500;
        }

        .theme-toggle {
            background: var(--card-background);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 8px 16px;
            border-radius: var(--radius-medium);
            cursor: pointer;
            font-size: 0.85rem;
            font-family: 'Source Sans Pro', sans-serif;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .theme-toggle:hover {
            background: var(--tertiary-dark);
            color: white;
            border-color: var(--tertiary-dark);
        }

        .theme-icon {
            font-size: 1rem;
        }

        /* Main Layout - Optimized for 16:9 monitor */
        .main-content {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 480px;
            gap: 32px;
            min-height: 0;
        }

        /* Calendar Section */
        .calendar-section {
            background: var(--card-background);
            border-radius: var(--radius-xl);
            padding: 20px 24px;
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--primary-dark);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(180deg, var(--tertiary-dark) 0%, var(--blue-pastel) 100%);
            border-radius: 2px;
        }

        .calendar-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            flex-shrink: 0;
        }

        .calendar-month {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .nav-buttons { display: flex; gap: 8px; }

        .nav-btn {
            background: var(--background);
            border: 1px solid var(--border);
            color: var(--secondary-dark);
            padding: 6px 14px;
            border-radius: var(--radius-medium);
            cursor: pointer;
            font-size: 0.85rem;
            font-family: 'Source Sans Pro', sans-serif;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background: var(--tertiary-dark);
            color: white;
            border-color: var(--tertiary-dark);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            flex: 1;
            align-content: start;
        }

        .calendar-header {
            text-align: center;
            padding: 8px 4px;
            font-weight: 600;
            color: var(--tertiary-dark);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .calendar-day {
            background: var(--background);
            border-radius: var(--radius-medium);
            padding: 12px;
            display: flex;
            flex-direction: column;
            transition: all 0.2s ease;
            border: 2px solid transparent;
            min-height: 85px;
        }

        .calendar-day:hover {
            background: var(--accent);
            border-color: var(--border);
        }

        .calendar-day.other-month { opacity: 0.3; }

        .calendar-day.today {
            border: 2px solid var(--highlight);
            background: rgba(212, 165, 116, 0.15);
            box-shadow: var(--shadow-light);
        }

        .day-number {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--muted-text);
            margin-bottom: 6px;
        }

        .calendar-day.today .day-number {
            color: var(--highlight);
            font-weight: 700;
        }

        .manager-name {
            font-size: 1.15rem;
            color: var(--text-primary);
            font-weight: 700;
            line-height: 1.2;
            background: linear-gradient(135deg, var(--tertiary-dark), var(--blue-pastel));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        /* Today's Manager Card */
        .today-card {
            background: linear-gradient(135deg, var(--tertiary-dark) 0%, var(--blue-pastel) 100%);
            border-radius: var(--radius-xl);
            padding: 28px 24px;
            text-align: center;
            box-shadow: var(--shadow-heavy);
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .today-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .today-card .label {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: rgba(255,255,255,0.85);
            margin-bottom: 8px;
            position: relative;
        }

        .today-card .manager {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            color: white;
            position: relative;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .today-card .date {
            font-size: 1rem;
            color: rgba(255,255,255,0.9);
            margin-top: 10px;
            position: relative;
        }

        /* Team Note Card */
        .note-card {
            background: var(--card-background);
            border-radius: var(--radius-xl);
            padding: 20px;
            box-shadow: var(--shadow-medium);
            border-left: 4px solid var(--highlight);
            transition: background 0.3s ease;
            flex-shrink: 0;
        }

        .note-card .label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--muted-text);
            margin-bottom: 10px;
        }

        .note-card .note-text {
            font-size: 1.05rem;
            color: var(--text-primary);
            line-height: 1.5;
            font-style: italic;
        }

        .note-card .note-text.empty {
            color: var(--muted-text);
            font-style: normal;
        }

        .note-card .note-author {
            font-size: 0.9rem;
            color: var(--secondary-dark);
            margin-top: 10px;
            font-weight: 500;
        }

        /* Quote Card */
        .quote-card {
            background: var(--card-background);
            border-radius: var(--radius-xl);
            padding: 20px;
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--border);
            position: relative;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 0;
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .quote-mark {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            color: var(--accent);
            line-height: 1;
            position: absolute;
            top: 10px;
            left: 16px;
        }

        .quote-card .label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--muted-text);
            margin-bottom: 12px;
        }

        .quote-text {
            font-size: 1rem;
            color: var(--text-primary);
            line-height: 1.5;
            font-style: italic;
            padding-left: 20px;
        }

        .quote-author {
            font-size: 0.9rem;
            color: var(--secondary-dark);
            margin-top: 12px;
            padding-left: 20px;
            font-weight: 500;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding-top: 12px;
            margin-top: auto;
            font-size: 0.8rem;
            color: var(--muted-text);
            flex-shrink: 0;
        }

        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
            margin-right: 6px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Responsive adjustments for smaller monitors */
        @media (max-width: 1400px) {
            .main-content {
                grid-template-columns: 1fr 340px;
            }
            .today-card .manager {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 1200px) {
            body { padding: 16px 20px; }
            .main-content {
                grid-template-columns: 1fr 300px;
                gap: 16px;
            }
            .header h1 { font-size: 2rem; }
            .today-card .manager { font-size: 2.2rem; }
            .calendar-day { min-height: 60px; padding: 6px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <h1>Laurino Tavern</h1>
                <div class="subtitle">Manager on Duty</div>
            </div>
            <div class="header-right">
                <div class="current-date" id="currentDate"></div>
                <button class="theme-toggle" onclick="toggleTheme()">
                    <span class="theme-icon" id="themeIcon">üåô</span>
                    <span id="themeText">Dark Mode</span>
                </button>
            </div>
        </header>

        <main class="main-content">
            <section class="calendar-section">
                <h2 class="section-title">Schedule</h2>
                <div class="calendar-nav">
                    <span class="calendar-month" id="calendarMonth"></span>
                    <div class="nav-buttons">
                        <button class="nav-btn" onclick="changeMonth(-1)">‚Üê Prev</button>
                        <button class="nav-btn" onclick="goToToday()">Today</button>
                        <button class="nav-btn" onclick="changeMonth(1)">Next ‚Üí</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <div class="calendar-header">Sun</div>
                    <div class="calendar-header">Mon</div>
                    <div class="calendar-header">Tue</div>
                    <div class="calendar-header">Wed</div>
                    <div class="calendar-header">Thu</div>
                    <div class="calendar-header">Fri</div>
                    <div class="calendar-header">Sat</div>
                </div>
            </section>

            <aside class="sidebar">
                <div class="today-card">
                    <div class="label">Today's Manager</div>
                    <div class="manager" id="todayManager">--</div>
                    <div class="date" id="todayDate"></div>
                </div>

                <div class="note-card">
                    <div class="label">üìã Team Note</div>
                    <div class="note-text" id="managerNote">Loading...</div>
                    <div class="note-author" id="noteAuthor"></div>
                </div>

                <div class="quote-card">
                    <span class="quote-mark">"</span>
                    <div class="label">üí° Daily Inspiration</div>
                    <div class="quote-text" id="quoteText"></div>
                    <div class="quote-author" id="quoteAuthor"></div>
                </div>
            </aside>
        </main>

        <footer class="footer">
            <span class="status-dot"></span>
            Auto-refresh enabled ¬∑ Last updated: <span id="lastUpdated">--</span>
        </footer>
    </div>

    <script>
        const CONFIG = {
            CALENDAR_DB_ID: '2f042fe32264805caeced964c5c1228e',
            NOTES_DB_ID: '2f042fe32264809297d6f75dfd050fa0',
            REFRESH_INTERVAL: 300000,
            API_ENDPOINT: '/api/notion'
        };

        const QUOTES = [
            { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { text: "Excellence is not a skill, it's an attitude.", author: "Ralph Marston" },
            { text: "Teamwork makes the dream work.", author: "John C. Maxwell" },
            { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
            { text: "Success usually comes to those who are too busy to be looking for it.", author: "Henry David Thoreau" },
            { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
            { text: "Quality is not an act, it is a habit.", author: "Aristotle" },
            { text: "The best way to predict the future is to create it.", author: "Peter Drucker" },
            { text: "Your most unhappy customers are your greatest source of learning.", author: "Bill Gates" },
            { text: "Coming together is a beginning, staying together is progress, working together is success.", author: "Henry Ford" },
            { text: "Hospitality is simply an opportunity to show love and care.", author: "Unknown" },
            { text: "Great things in business are never done by one person.", author: "Steve Jobs" },
            { text: "It's not about perfect. It's about effort.", author: "Jillian Michaels" },
            { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
            { text: "Success is the sum of small efforts repeated day in and day out.", author: "Robert Collier" },
            { text: "Customers will never love a company until the employees love it first.", author: "Simon Sinek" },
            { text: "The customer's perception is your reality.", author: "Kate Zabriskie" },
            { text: "Kindness in words creates confidence. Kindness in thinking creates profoundness. Kindness in giving creates love.", author: "Lao Tzu" },
            { text: "Alone we can do so little; together we can do so much.", author: "Helen Keller" },
            { text: "The strength of the team is each member. The strength of each member is the team.", author: "Phil Jackson" },
            { text: "People don't care how much you know until they know how much you care.", author: "Theodore Roosevelt" },
            { text: "Service to others is the rent you pay for your room here on earth.", author: "Muhammad Ali" },
            { text: "The goal is not to be perfect by the end. The goal is to be better today.", author: "Simon Sinek" },
            { text: "Be the change you wish to see in the world.", author: "Mahatma Gandhi" },
            { text: "Every job is a self-portrait of the person who did it. Autograph your work with excellence.", author: "Unknown" },
            { text: "If you want to lift yourself up, lift up someone else.", author: "Booker T. Washington" },
            { text: "A satisfied customer is the best business strategy of all.", author: "Michael LeBoeuf" },
            { text: "Hard work beats talent when talent doesn't work hard.", author: "Tim Notke" },
            { text: "Success is not the key to happiness. Happiness is the key to success.", author: "Albert Schweitzer" },
            { text: "The pessimist sees difficulty in every opportunity. The optimist sees opportunity in every difficulty.", author: "Winston Churchill" },
            { text: "Wherever you go, go with all your heart.", author: "Confucius" }
        ];

        let calendarDate = new Date();
        let managerSchedule = {};
        let dailyNotes = {};

        // Theme Toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeButton(newTheme);
        }

        function updateThemeButton(theme) {
            const icon = document.getElementById('themeIcon');
            const text = document.getElementById('themeText');
            if (theme === 'dark') {
                icon.textContent = '‚òÄÔ∏è';
                text.textContent = 'Light Mode';
            } else {
                icon.textContent = 'üåô';
                text.textContent = 'Dark Mode';
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeButton(savedTheme);
        }

        // Utility Functions
        function formatDate(date) {
            return date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatDateShort(date) {
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function getDateKey(date) {
            return date.toISOString().split('T')[0];
        }

        function getDayOfYear() {
            const now = new Date();
            const start = new Date(now.getFullYear(), 0, 0);
            return Math.floor((now - start) / (1000 * 60 * 60 * 24));
        }

        function getQuoteOfTheDay() {
            return QUOTES[getDayOfYear() % QUOTES.length];
        }

        // Extract manager name from formats like "Z on duty", "A On Duty", or just "Z"
        function extractManagerName(rawName) {
            if (!rawName) return '';
            // Remove common suffixes like "on duty", "On Duty", "- Manager", etc.
            let name = rawName
                .replace(/\s*(on duty|on-duty|manager|- manager|\(manager\))\s*/gi, '')
                .trim();
            // If we end up with empty string, return original
            return name || rawName;
        }

        function displayQuote() {
            const quote = getQuoteOfTheDay();
            document.getElementById('quoteText').textContent = quote.text;
            document.getElementById('quoteAuthor').textContent = '‚Äî ' + quote.author;
        }

        // Notion API Functions
        async function fetchNotionDatabase(databaseId) {
            try {
                const response = await fetch(CONFIG.API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ databaseId: databaseId })
                });
                if (!response.ok) throw new Error('API error: ' + response.status);
                return await response.json();
            } catch (error) {
                console.error('Error fetching from Notion:', error);
                return null;
            }
        }

        async function loadManagerSchedule() {
            const data = await fetchNotionDatabase(CONFIG.CALENDAR_DB_ID);
            if (!data || !data.results) {
                console.error('Failed to load manager schedule');
                return;
            }
            
            managerSchedule = {};
            
            data.results.forEach(page => {
                const props = page.properties;
                let dateValue = null;
                let managerValue = null;
                
                // Debug: log what we're getting
                console.log('Processing page:', page.id);
                
                for (const [key, prop] of Object.entries(props)) {
                    console.log(`  Property "${key}":`, prop.type, prop);
                    
                    // Get date
                    if (prop.type === 'date' && prop.date) {
                        dateValue = prop.date.start;
                    }
                    
                    // Get manager name from title (like "Z on duty" or "A On Duty")
                    if (prop.type === 'title' && prop.title && prop.title.length > 0) {
                        managerValue = prop.title[0].plain_text;
                    }
                    
                    // Also check rich_text as fallback
                    if (prop.type === 'rich_text' && prop.rich_text && prop.rich_text.length > 0 && !managerValue) {
                        managerValue = prop.rich_text[0].plain_text;
                    }
                    
                    // Check select as another fallback
                    if (prop.type === 'select' && prop.select && !managerValue) {
                        managerValue = prop.select.name;
                    }
                }
                
                if (dateValue && managerValue) {
                    // Extract just the manager name (e.g., "Z" from "Z on duty")
                    const cleanName = extractManagerName(managerValue);
                    managerSchedule[dateValue] = cleanName;
                    console.log(`  -> Mapped: ${dateValue} = "${cleanName}" (from "${managerValue}")`);
                }
            });
            
            console.log('Final managerSchedule:', managerSchedule);
        }

        async function loadDailyNotes() {
            const data = await fetchNotionDatabase(CONFIG.NOTES_DB_ID);
            if (!data || !data.results) return;
            
            dailyNotes = {};
            
            data.results.forEach(page => {
                const props = page.properties;
                let dateValue = null;
                let noteValue = null;
                let managerValue = null;
                
                for (const [key, prop] of Object.entries(props)) {
                    // Get date
                    if (prop.type === 'date' && prop.date) {
                        dateValue = prop.date.start;
                    }
                    
                    // Look for note content
                    if (key.toLowerCase().includes('note') || key.toLowerCase().includes('daily')) {
                        if (prop.type === 'rich_text' && prop.rich_text && prop.rich_text.length > 0) {
                            noteValue = prop.rich_text.map(t => t.plain_text).join('');
                        }
                        if (prop.type === 'title' && prop.title && prop.title.length > 0) {
                            noteValue = prop.title.map(t => t.plain_text).join('');
                        }
                    }
                    
                    // Look for manager name
                    if (key.toLowerCase().includes('manager') || key.toLowerCase().includes('name')) {
                        if (prop.type === 'title' && prop.title && prop.title.length > 0) {
                            managerValue = prop.title[0].plain_text;
                        }
                        if (prop.type === 'rich_text' && prop.rich_text && prop.rich_text.length > 0) {
                            managerValue = prop.rich_text[0].plain_text;
                        }
                    }
                }
                
                if (dateValue) {
                    dailyNotes[dateValue] = { 
                        note: noteValue || '', 
                        manager: managerValue ? extractManagerName(managerValue) : '' 
                    };
                }
            });
        }

        // UI Update Functions
        function updateCurrentDate() {
            document.getElementById('currentDate').textContent = formatDate(new Date());
            document.getElementById('todayDate').textContent = formatDateShort(new Date());
        }

        function updateTodayManager() {
            const todayKey = getDateKey(new Date());
            const manager = managerSchedule[todayKey] || '--';
            document.getElementById('todayManager').textContent = manager;
        }

        function updateDailyNote() {
            const noteData = dailyNotes[getDateKey(new Date())];
            const noteEl = document.getElementById('managerNote');
            const authorEl = document.getElementById('noteAuthor');
            
            if (noteData && noteData.note && noteData.note.trim()) {
                noteEl.textContent = noteData.note;
                noteEl.classList.remove('empty');
                authorEl.textContent = noteData.manager ? '‚Äî ' + noteData.manager : '';
            } else {
                noteEl.textContent = 'No team notes for today';
                noteEl.classList.add('empty');
                authorEl.textContent = '';
            }
        }

        function renderCalendar() {
            const year = calendarDate.getFullYear();
            const month = calendarDate.getMonth();
            
            document.getElementById('calendarMonth').textContent = 
                calendarDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startingDay = firstDay.getDay();
            const totalDays = lastDay.getDate();
            const todayKey = getDateKey(new Date());
            
            const grid = document.getElementById('calendarGrid');
            const headers = grid.querySelectorAll('.calendar-header');
            grid.innerHTML = '';
            headers.forEach(h => grid.appendChild(h));
            
            // Previous month days
            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day other-month';
                const prevMonthLastDay = new Date(year, month, 0).getDate();
                emptyDay.innerHTML = `<span class="day-number">${prevMonthLastDay - startingDay + i + 1}</span>`;
                grid.appendChild(emptyDay);
            }
            
            // Current month days
            for (let day = 1; day <= totalDays; day++) {
                const date = new Date(year, month, day);
                const dateKey = getDateKey(date);
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day' + (dateKey === todayKey ? ' today' : '');
                
                const manager = managerSchedule[dateKey] || '';
                dayEl.innerHTML = `
                    <span class="day-number">${day}</span>
                    ${manager ? `<span class="manager-name">${manager}</span>` : ''}
                `;
                grid.appendChild(dayEl);
            }
            
            // Next month days
            const remainingCells = (7 - ((startingDay + totalDays) % 7)) % 7;
            for (let i = 1; i <= remainingCells; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day other-month';
                emptyDay.innerHTML = `<span class="day-number">${i}</span>`;
                grid.appendChild(emptyDay);
            }
        }

        function changeMonth(delta) {
            calendarDate.setMonth(calendarDate.getMonth() + delta);
            renderCalendar();
        }

        function goToToday() {
            calendarDate = new Date();
            renderCalendar();
        }

        function updateLastUpdated() {
            document.getElementById('lastUpdated').textContent = 
                new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
        }

        // Initialize
        async function init() {
            loadTheme();
            updateCurrentDate();
            displayQuote();
            
            await Promise.all([loadManagerSchedule(), loadDailyNotes()]);
            
            updateTodayManager();
            updateDailyNote();
            renderCalendar();
            updateLastUpdated();
        }

        async function refresh() {
            await Promise.all([loadManagerSchedule(), loadDailyNotes()]);
            updateCurrentDate();
            updateTodayManager();
            updateDailyNote();
            renderCalendar();
            updateLastUpdated();
            displayQuote();
        }

        document.addEventListener('DOMContentLoaded', () => {
            init();
            setInterval(refresh, CONFIG.REFRESH_INTERVAL);
        });
    </script>
</body>
</html>
